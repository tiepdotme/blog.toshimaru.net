---
layout: post
title: メールアドレスにはRFC的に使用可能な文字(!#$%&'*+-/=?^_`{|}~)は使わないほうが良い
published: true
description: メールアドレスのローカル部に使用できる記号について調べた。調べるきっかけはGmailの+（プラス）アドレスを使おうとしたこと。
tags: mail rfc
---

メールアドレスのローカル部に使用できる記号について調べた。調べるきっかけはGmailの`+`（プラス）の入ったアドレスを使おうとしたこと。

> Gmail が次のような仕様になっているからだ。
>
> * `・``.`(ドット/ピリオド)は無視される
> * `+`(プラス) から`@`までは無視される

via. [Gmail における .(ドット/ピリオド) と +(プラス) の扱いの不思議](http://blog.livedoor.jp/lalha/archives/50158699.html)

上記のようなgmail仕様から、例えば会員登録機能を開発したときに、１つのgmailアカウントをとってそれを使い回せばテストするのにいろいろと便利なのです（myaddress+test1@gmail.com, myaddress+test2@gmail.com  という具合に１つのメールアドレスで複数サービスに登録できます）。

## プラス記号が使えなかった

ということで自分が作った会員登録機能でこのプラスアドレスを使おうと思ったが、どういうわけか不正なメールアドレスとして弾かれる。調べてみると、開発においてとあるバリデーションのライブラリを使用していたのだが、そのバリデーション機構がプラスを弾いているらしいことがわかった。

[メールアドレスに + を使うと危ない件](http://n.h7a.org/blog/entry/1509)

え？プラスって使っちゃいけないのか？ （タイトルだけ読んで判断したが、元記事はそんなことは全くいってません）

## RFC的に使ってよい文字

RFC的にはどーなんだろうか。調べてみよう。

> 上記をまとめると、メールアドレスに使える文字は
>
>     アルファベット 数字 ! # $ % & ’ * + - / = ? ^ _ ` { | } ~ .
>
> となります。`.`は先頭と最後には利用することができません。

via. [メールアドレスで使える記号](http://www.go5.jp/~nyomo/net/mailaddr.html)

仕様的には使える記号はこんなあるのか。

## リアル・ワールドで安心して使えそうな文字

だが実際のところ同記事に書いてあるとおり、プロバイダ側で使える文字を制限しているのが現実です。

> メールでの利用やwebサイトに掲載の際に安心して利用できる文字種は以下の通り
>
> * アルファベットの大文字と小文字
> * 数字
> * -(ハイフン)
> * _(アンダーバー)
> * .(ピリオド)但し利用制限あり(@の直前は不可、連続しての利用も不可)

via. [メールアドレスで使える記号](http://www.go5.jp/~nyomo/net/mailaddr.html)

結局のところ安心して使えるのは上記の文字、となるようです。RFCは個人的にはネットワークにおける聖典、絶対的な価値基準だと思っていたけどそんなことはないようです。[RFCを守らない大手通信キャリアさん](http://ke-tai.org/blog/2009/09/25/aurfc/)もある（あった）ようですので（そのメールアドレスにメールを送ろうとする度にiPhoneに怒られてます）、まだRFCの基準の範囲内にあるだけよいのかもしれません。

## まとめ

* メールアドレスとして安心して使える使用可能文字は「アルファベット」,「数字」,「-」（ハイフン）,「_」（アンダースコア）,「.」（ドット）
* RFCが言っているからといって、それが正解とは限らないよ！
