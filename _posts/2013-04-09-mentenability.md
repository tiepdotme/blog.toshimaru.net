---
layout: post
title: メンテナビリティの高いコードを書くメリット
published: true
description: 
tags: tech
---

[コードは汚くていい。「アイツがいれば勝てる」と言わせろ。](http://careerhack.en-japan.com/report/detail/66)に対するあるはてな匿名ダイアリー記事を読んでいて考えたこと。

良いコードはエンドユーザにとってはどうでもいい
-----
> 非エンジニアを騙して手抜きするのは簡単。余程のヘタレでない限り手抜きをしても絶対にばれない。コードにコメントがなくてもモジュール化されてなくてもコピペ満載でもマジックナンバーだらけでも動いてさえいればユーザーは気にしない。
>
> [会社潰すのは簡単、アイツがいれば勝てる、と思った人間を雇えば良い](http://anond.hatelabo.jp/20121201025247)

そう、単純に速く作るのは難しくはない。なんにも考えずにただ思いつくままに上から下に書いていけばいい。そうして出来上がったコードは大抵はひどいものだ。要らないコードがコメントアウトされて残り、バージョン管理されたコミットログもまともに書かれず、ネストが深く、関数化もまともにされていない、こんなコードだ。

無論、「良いコード」「綺麗なコード」の多くはユーザにとっては無意味なものであり、どうでもいいものである。 ユーザにとっての最大の関心事はそのアプリケーションが面白いか面白くないか、正しく動くかどうか、バグがないかどうかであり、コードが良いか悪いかなんてアウトオブ眼中である。

悪いコードは生産性を下げる？
-----
じゃあ悪い手抜きコードでいいのか？　というとそんなことはないはず。

> 手抜きコードをメンテさせられるプログラマの生産性は落ちる
> 
> 手抜きコードのメンテはプログラマにとって最悪の仕事。綺麗なコードで数十分でできる仕事が２週間かかることもしばしば。最悪の仕事をさせられ、「仕事が遅い」と評価され、モチベーションが下がって更に仕事が遅くなる。
>
> [会社潰すのは簡単、アイツがいれば勝てる、と思った人間を雇えば良い](http://anond.hatelabo.jp/20121201025247)

このことは「悪い」コードをメンテナンスさせられた経験のある人にとっては当然なことだと思う。

悪いコードは３行で書けることをきっと10行で書くだろう。また、悪いコードは5メソッドに分けるべきところを1メソッドに書くだろう。ときに悪いコードは3ファイルに分けるところを1ファイルに集約するだろう。悪いコードはオブジェクト指向をうまく利用できていないだろう。

このようなコードのメンテナンスは大変骨の折れる作業で、メンテナンスコストは高くつく。このメンテナンスコストも含めてトータルでコスト計算すると結局、コストは手抜きコードのほうが高くつくのではないだろうか。つまり数式にするとこのようになるだろう。

**手抜きコードを書くコスト＋そのメンテナンスコスト　＞　ちゃんと考えて書いた良いコード＋そのメンテナンスコスト**

ただ問題は前者がイニシャルコストが安いので、一見「トータルコストも安く済むのでは？」と思えてしまうところだ。悪いコードをメンテナンスしたことのない非プログラマにとっては当然とも言えるが・・・。

メンテナビリティの高いコードを書くメリットは何か
-------
メンテナビリティの高いコードを書くメリットは何だろうか。まず上記にあげたように「メンテナンス時のコストが下がりトータルコストが下がる」ことである。

例えばあるソーシャルゲームを考えてみよう。それが使い捨てのゲームアプリであればひどいコードでいいかもしれない。だが中長期的にそのアプリを運用していくのであれば、メンテナビリティの高いコードを書くべきだ。それにより、保守コストは下がり、トータルコストは低くなる。

> ソースコードの理解に時間を要したり、最悪の場合、なぜそういうコードになっているのか最後までわからず、「触ると危ないコード」> になってしまうようなら、例え機能的に要件を満たせていても、中長期のメンテナンスの観点から言えば、そのソースコードはコミットしない方がプロジェクトのためになります。
>
> [メンテナビリティの高いソースコードを目指して](http://blog.livedoor.jp/lalha/archives/50435614.html)

またコードに気を使っている会社には「優秀なプログラマが集まる」だろう。言い換えるならば、コードに気を使う会社にはコードに気を使う優秀なプログラマが集まるし、そうでなければコードに無頓着なプログラマが集まるだろう。

こんな要望に対して優秀なプログラマはどう思うだろうか？ 「アプリ作って。期限は◯◯までで、ヨロシク。え？テスト書くかって？　あー要らない要らない。ちゃんと動いていればいいから。」きっと気持ちが萎えてしまうだろう。

まとめ
-------
* メンテナンス時のコストが下がる→トータルコストが下がる
* 優秀なプログラマが集まる

上述した理由により、基本的に私は「いかなる場合でもメンテナビリティを意識したコードを書くべきだ」という姿勢だ。

コードを書くことが目的ではない
-------
ただ最後に記しておきたいのはコードを書くこと自体は目的ではないということだ。会社のビジネスを成功に導くためにコード/プログラムがあるのであり、そのことはプログラマが忘れてはならないことである。

> 綺麗に書くのなんて当たり前、そしてその先で実現できるモノづくりに全力を尽くす。
>
> [コードの綺麗さの先にあるもの](http://kyuns.hatenablog.com/entry/2012/11/30/143037)

> まつもと氏は、美しいコードというものがあるという。それはアートで、「プログラマはアーティストだ」と言い切る。（中略）アートだと言ってもプログラムは飾るのが目的ではない。「実用に供してなんぼ。日本では用の美というらしいですが、どのぐらい目的に合致しつつ美しいかが重要」
>
> [「ソフトウェアは工業製品ではない」、Rubyのまつもと氏が講演](http://www.atmarkit.co.jp/news/200904/10/matz.html)

関連エントリ
-------
* [ダメプログラマの8つの特徴](http://blog.toshimaru.net/8/)
